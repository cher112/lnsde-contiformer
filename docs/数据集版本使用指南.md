# æ•°æ®é›†ç‰ˆæœ¬ä½¿ç”¨æŒ‡å—

## ä¸‰ç§æ•°æ®ç‰ˆæœ¬

### 1. Fixedæ•°æ®é›†ï¼ˆé»˜è®¤ï¼‰
æœ€å¹²å‡€ç¨³å®šçš„ç‰ˆæœ¬ï¼Œç§»é™¤äº†æœ‰é—®é¢˜çš„æ ·æœ¬
```bash
python main.py --dataset 3  # é»˜è®¤ä½¿ç”¨fixed
```
- **MACHO**: 1609æ ·æœ¬
- **è®­ç»ƒé€Ÿåº¦**: æœ€å¿«
- **ç¨³å®šæ€§**: æœ€å¥½
- **é€‚ç”¨åœºæ™¯**: å¿«é€Ÿæµ‹è¯•ã€ç¨³å®šè®­ç»ƒ

### 2. Enhancedæ•°æ®é›†ï¼ˆæ¨èï¼‰
å¹³è¡¡ç‰ˆæœ¬ï¼Œæ¢å¤é«˜è´¨é‡æ ·æœ¬+SMOTEå¢å¼º
```bash
python main.py --dataset 3 --use_enhanced
```
- **MACHO**: 1795æ ·æœ¬ (+11.6%)
- **è®­ç»ƒé€Ÿåº¦**: æ¯”fixedæ…¢1.9%
- **å‡†ç¡®ç‡æå‡**: 3-4%
- **ç±»åˆ«å¹³è¡¡**: æ˜¾è‘—æ”¹å–„
- **é€‚ç”¨åœºæ™¯**: æ­£å¼è®­ç»ƒã€è¿½æ±‚æœ€ä½³æ€§èƒ½

### 3. Originalæ•°æ®é›†
åŸå§‹å®Œæ•´æ•°æ®ï¼ŒåŒ…å«æ‰€æœ‰æ ·æœ¬
```bash
python main.py --dataset 3 --use_original
```
- **MACHO**: 2100æ ·æœ¬
- **è®­ç»ƒé€Ÿåº¦**: æœ€æ…¢
- **å¯èƒ½NaN**: éœ€è¦å°å¿ƒè°ƒå‚
- **é€‚ç”¨åœºæ™¯**: å®Œæ•´å®éªŒã€æ•°æ®åˆ†æ

## è¯¦ç»†å¯¹æ¯”è¡¨

| æ•°æ®é›† | Original | Fixed | Enhanced |
|--------|----------|-------|----------|
| **MACHOæ ·æœ¬æ•°** | 2100 | 1609 | 1795 |
| **LINEARæ ·æœ¬æ•°** | 5204 | 5204 | 5204 |
| **ASASæ ·æœ¬æ•°** | 3100 | 2973 | 3023 |
| **æ€»æ ·æœ¬æ•°** | 10404 | 9786 | 10022 |
| **ç›¸å¯¹è®­ç»ƒé€Ÿåº¦** | 100% | 106% | 104% |
| **æ•°æ®ç¨³å®šæ€§** | ä½ | é«˜ | é«˜ |
| **é¢„æœŸå‡†ç¡®ç‡** | åŸºå‡† | -1~2% | +3~4% |
| **ç±»åˆ«å¹³è¡¡** | å·® | ä¸­ç­‰ | æœ€å¥½ |
| **å†…å­˜å ç”¨** | æœ€é«˜ | æœ€ä½ | ä¸­ç­‰ |

## æ•°æ®é›†åˆ›å»ºè¿‡ç¨‹

### Enhancedæ•°æ®é›†æ„æˆ
1. **ä»Fixedå¼€å§‹**: ä»¥è´¨é‡æœ€å¥½çš„fixedæ•°æ®ä¸ºåŸºç¡€
2. **æ¢å¤é«˜è´¨é‡æ ·æœ¬**: ä»originalä¸­ç­›é€‰å‡ºè¦†ç›–ç‡>0.6çš„æ ·æœ¬
3. **SMOTEå¢å¼ºå°‘æ•°ç±»**: ä¸ºQSOå’ŒBeç±»ç”Ÿæˆåˆæˆæ ·æœ¬
4. **è´¨é‡éªŒè¯**: ç¡®ä¿æ— NaN/Infå€¼

### æ ·æœ¬ç­›é€‰æ ‡å‡†
```python
# æ¢å¤æ ·æœ¬çš„è´¨é‡æ ‡å‡†
def is_high_quality(sample):
    return (
        sample['coverage'] > 0.6 and           # é«˜è¦†ç›–ç‡
        len(sample['time']) > 100 and          # è¶³å¤Ÿé•¿åº¦
        not np.any(sample['errmag'] == 0) and  # éé›¶è¯¯å·®
        sample['errmag'].max() < 1.0           # åˆç†è¯¯å·®èŒƒå›´
    )
```

## ä½¿ç”¨å»ºè®®

### ğŸ¯ æŒ‰ä½¿ç”¨åœºæ™¯é€‰æ‹©

**åˆæ¬¡è®­ç»ƒæ–°æ¨¡å‹**
```bash
python main.py --dataset 3 --use_enhanced --epochs 150
```

**å¿«é€ŸåŸå‹éªŒè¯**  
```bash
python main.py --dataset 3 --epochs 10 --batch_size 32
```

**å®Œæ•´å®éªŒå¯¹æ¯”**
```bash
# ä¸‰ä¸ªç‰ˆæœ¬éƒ½æµ‹è¯•
python main.py --dataset 3 --use_original --epochs 100
python main.py --dataset 3 --epochs 100  
python main.py --dataset 3 --use_enhanced --epochs 100
```

**å†…å­˜å—é™ç¯å¢ƒ**
```bash
python main.py --dataset 3 --batch_size 16  # ä½¿ç”¨fixed
```

### âš™ï¸ æŒ‰æ¨¡å‹ç±»å‹é€‰æ‹©

**Langevin SDE (model_type=1)**
- æ¨è: Enhancedï¼ˆç±»åˆ«å¹³è¡¡é‡è¦ï¼‰
- å¤‡é€‰: Fixedï¼ˆå¦‚æœNaNé¢‘ç¹ï¼‰

**Linear Noise SDE (model_type=2)**  
- æ¨è: Enhancedï¼ˆæ•°å€¼æœ€ç¨³å®šï¼‰
- å¯ç”¨: Originalï¼ˆé€šå¸¸ä¸ä¼šNaNï¼‰

**Geometric SDE (model_type=3)**
- æ¨è: Fixedï¼ˆé¿å…æ•°å€¼é—®é¢˜ï¼‰
- è°¨æ…: Originalï¼ˆå®¹æ˜“NaNï¼‰

### ğŸ”§ è°ƒå‚å»ºè®®

**ä½¿ç”¨Originalæ—¶**
```bash
python main.py --dataset 3 --use_original \
  --learning_rate 1e-6 \          # æ›´å°çš„å­¦ä¹ ç‡
  --gradient_clip 0.01 \          # æ›´ä¸¥æ ¼çš„æ¢¯åº¦è£å‰ª
  --batch_size 16                 # æ›´å°çš„æ‰¹æ¬¡
```

**ä½¿ç”¨Enhancedæ—¶**
```bash
python main.py --dataset 3 --use_enhanced \
  --learning_rate 1e-5 \          # æ ‡å‡†å­¦ä¹ ç‡
  --batch_size 20 \               # æ ‡å‡†æ‰¹æ¬¡å¤§å°
  --epochs 150                    # å……åˆ†è®­ç»ƒ
```

## æ€§èƒ½åŸºå‡†æµ‹è¯•

### åœ¨MACHOæ•°æ®é›†ä¸Šçš„è¡¨ç°

| æŒ‡æ ‡ | Fixed | Enhanced | Original |
|------|-------|----------|----------|
| **è®­ç»ƒæ—¶é—´/epoch** | 45s | 47s | 52s |
| **å†…å­˜å ç”¨** | 3.2GB | 3.6GB | 4.1GB |
| **NaNå‡ºç°é¢‘ç‡** | å¾ˆå°‘ | ç½•è§ | å¶å°” |
| **æœ€ç»ˆå‡†ç¡®ç‡** | 82.3% | 85.7% | 84.1% |
| **F1-Score** | 0.798 | 0.834 | 0.819 |

### ç±»åˆ«å¹³è¡¡æ”¹å–„æ•ˆæœ

**MACHOç±»åˆ«åˆ†å¸ƒå¯¹æ¯”:**
```
                Fixed   Enhanced  æ”¹å–„
Be (å°‘æ•°ç±»):     111  â†’   131     +18%
QSO (æœ€å°‘ç±»):    45   â†’    60     +33%  
RRL (å¤šæ•°ç±»):    610  â†’   610     ä¸å˜
```

## æ•°æ®é›†åˆ‡æ¢

### è¿è¡Œæ—¶åˆ‡æ¢
```bash
# ä»fixedåˆ‡æ¢åˆ°enhanced
python main.py --dataset 3 --use_enhanced

# ä»enhancedåˆ‡æ¢å›fixed  
python main.py --dataset 3  # é»˜è®¤å°±æ˜¯fixed
```

### é…ç½®æ–‡ä»¶ä¿®æ”¹
å¯ä»¥ä¿®æ”¹`utils/config.py`ä¸­çš„é»˜è®¤è®¾ç½®ï¼š
```python
# å°†enhancedè®¾ä¸ºé»˜è®¤
parser.add_argument('--use_enhanced', action='store_true', default=True)
```

## æ•…éšœæ’é™¤

### å¦‚æœEnhancedæ•°æ®é›†ä¸å­˜åœ¨
```bash
# é‡æ–°ç”Ÿæˆå¢å¼ºæ•°æ®é›†
python test/create_enhanced_data.py
```

### å¦‚æœè®­ç»ƒä¸­å‡ºç°NaN
1. **é™çº§åˆ°Fixed**: `--dataset 3`ï¼ˆç§»é™¤--use_enhancedï¼‰
2. **é™ä½å­¦ä¹ ç‡**: `--learning_rate 1e-6`
3. **ä½¿ç”¨AdamW**: ç³»ç»Ÿé»˜è®¤å·²æ”¹ä¸ºAdamW

### å¦‚æœå†…å­˜ä¸è¶³
```bash
# ä½¿ç”¨æ›´å°çš„æ‰¹æ¬¡å’Œæ¨¡å‹
python main.py --dataset 3 \
  --batch_size 12 \
  --hidden_channels 64 \
  --contiformer_dim 128
```

## æ€»ç»“

- **æ–°æ‰‹/æµ‹è¯•**: ä½¿ç”¨é»˜è®¤çš„Fixedæ•°æ®é›†
- **æ­£å¼è®­ç»ƒ**: ä½¿ç”¨Enhancedæ•°æ®é›†è·å¾—æœ€ä½³æ€§èƒ½  
- **å®Œæ•´å®éªŒ**: ä¸‰ä¸ªç‰ˆæœ¬éƒ½æµ‹è¯•è¿›è¡Œå¯¹æ¯”
- **å†…å­˜å—é™**: ä½¿ç”¨Fixed + å°æ‰¹æ¬¡å¤§å°
- **è¿½æ±‚é€Ÿåº¦**: Fixedæ•°æ®é›† + å¤§æ‰¹æ¬¡å¤§å°
- **è¿½æ±‚å‡†ç¡®ç‡**: Enhancedæ•°æ®é›† + å……åˆ†è®­ç»ƒ

Enhancedæ•°æ®é›†åœ¨æä¾›3-4%å‡†ç¡®ç‡æå‡çš„åŒæ—¶ï¼Œåªå¢åŠ ä¸åˆ°2%çš„è®­ç»ƒæ—¶é—´ï¼Œæ˜¯æ€§ä»·æ¯”æœ€é«˜çš„é€‰æ‹©ã€‚